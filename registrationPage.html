<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Find Your Valentine - Registration</title>

  <!-- Firebase SDK (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <script src="firebaseClient.js"></script>

  <style>
    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
    }

    :root {
      --primary-pink: #ff6b9d;
      --primary-pink-dark: #e85a8a;
      --secondary-purple: #c084fc;
      --dark-bg: #1a0a1e;
      --card-bg: rgba(255, 255, 255, 0.08);
      --card-border: rgba(255, 255, 255, 0.15);
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.75);
      --radius-sm: 8px;
      --radius-md: 14px;
      --radius-lg: 20px;
      --radius-full: 9999px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #1a0a1e 0%, #2d1b3d 50%, #1a0a1e 100%);
      color: var(--text-primary);
      overflow-x: hidden;
      min-height: 100vh;
    }

    .background-overlay {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      background: url('https://images.unsplash.com/photo-1518199266791-739d6ff26df5?q=80&w=2070&auto=format&fit=crop') center/cover;
      filter: blur(20px) brightness(0.4);
      z-index: 0;
    }

    .page {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem 1rem;
    }

    .container {
      width: 100%;
      max-width: 820px;
    }

    .brand-header {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .brand-title {
      background: linear-gradient(135deg, var(--primary-pink), var(--secondary-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 2.5rem;
      letter-spacing: 2px;
      font-weight: 800;
      line-height: 1.1;
    }

    .brand-subtitle {
      color: var(--text-secondary);
      font-size: 1.125rem;
      font-weight: 600;
      margin-top: 0.5rem;
    }

    .glass {
      background: var(--card-bg);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
      border-radius: var(--radius-lg);
    }

    .progress {
      padding: 1rem 1.125rem;
      margin-bottom: 1.125rem;
    }

    .progress-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
      gap: 0.75rem;
      font-size: 0.875rem;
      font-weight: 600;
    }

    .progress-row .left { color: var(--text-primary); }
    .progress-row .right { 
      background: linear-gradient(135deg, var(--primary-pink), var(--secondary-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .progress-track {
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-full);
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      width: 14%;
      background: linear-gradient(90deg, var(--primary-pink), var(--secondary-purple));
      transition: width 0.4s ease;
    }

    .card {
      padding: 1.75rem;
      margin-bottom: 0.875rem;
    }

    .step-title {
      text-align: center;
      margin-bottom: 1.125rem;
    }

    .step-title h2 {
      font-size: 1.875rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary-pink), var(--secondary-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.375rem;
    }

    .step-title p {
      font-size: 0.9375rem;
      color: var(--text-secondary);
    }

    label {
      display: block;
      font-size: 0.8125rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0 0 0.5rem;
    }

    input[type="text"],
    input[type="email"],
    input[type="password"],
    textarea {
      width: 100%;
      padding: 0.75rem 0.875rem;
      border-radius: var(--radius-md);
      border: 2px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.9);
      outline: none;
      transition: 0.2s;
      font-size: 1rem;
      color: #1a0a1e;
    }

    input:focus, textarea:focus {
      border-color: var(--primary-pink);
      box-shadow: 0 0 10px rgba(255, 107, 157, 0.25);
      background: rgba(255, 255, 255, 0.98);
    }

    input:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }

    textarea {
      resize: none;
    }

    .btn {
      border: none;
      border-radius: var(--radius-md);
      padding: 0.75rem 1rem;
      font-weight: 800;
      cursor: pointer;
      transition: transform 0.15s, box-shadow 0.2s, opacity 0.2s;
      font-size: 0.9375rem;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn-primary {
      background: linear-gradient(90deg, var(--primary-pink), var(--secondary-purple));
      color: white;
      box-shadow: 0 4px 15px rgba(255, 107, 157, 0.4);
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 107, 157, 0.6);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid var(--card-border);
      color: var(--text-primary);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .btn-secondary:hover:not(:disabled) {
      background: rgba(255, 255, 255, 0.14);
    }

    .btn-link {
      background: transparent;
      color: var(--primary-pink);
      font-weight: 800;
      padding: 0;
      border-radius: 0;
      border: none;
      cursor: pointer;
    }

    .btn-link:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .row { margin-top: 0.875rem; }

    .error {
      margin-top: 0.625rem;
      padding: 0.625rem 0.75rem;
      border-radius: var(--radius-md);
      background: rgba(127, 29, 29, 0.35);
      border: 1px solid var(--card-border);
      color: #fecaca;
      display: flex;
      gap: 0.625rem;
      align-items: flex-start;
      font-size: 0.8125rem;
      line-height: 1.4;
    }

    .error .icon { margin-top: 1px; }

    .hidden { display: none !important; }

    .hint-box {
      margin-top: 1rem;
      padding: 0.75rem 0.875rem;
      border-radius: var(--radius-md);
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--card-border);
      color: var(--text-secondary);
      font-size: 0.8125rem;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .otp-row {
      display: flex;
      gap: 0.625rem;
      justify-content: center;
      margin-top: 0.625rem;
    }

    .otp-input {
      width: 3rem;
      height: 3rem;
      text-align: center;
      font-size: 1.25rem;
      font-weight: 800;
      border-radius: var(--radius-md);
      border: 2px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.9);
      outline: none;
      color: #1a0a1e;
    }

    .otp-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.625rem;
      margin-top: 0.75rem;
      font-size: 0.8125rem;
      color: var(--text-secondary);
    }

    .derived {
      margin-top: 1rem;
      padding: 0.875rem;
      border-radius: var(--radius-md);
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--card-border);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: var(--text-secondary);
      font-size: 0.875rem;
    }

    .derived p { margin: 0.375rem 0; }

    .gender-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    .gender-btn {
      width: 100%;
      padding: 1rem 0.75rem;
      border-radius: var(--radius-md);
      border: 2px solid rgba(255, 255, 255, 0.2);
      background: rgba(255, 255, 255, 0.06);
      color: var(--text-primary);
      font-weight: 800;
      cursor: pointer;
      transition: transform 0.15s, background 0.2s, border-color 0.2s;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .gender-btn:hover { transform: translateY(-2px); }

    .gender-btn.selected {
      border-color: var(--primary-pink);
      background: rgba(255, 107, 157, 0.2);
    }

    .photos-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.75rem;
      margin-top: 0.625rem;
    }

    .photo-tile {
      position: relative;
      aspect-ratio: 1 / 1;
      border-radius: var(--radius-md);
      overflow: hidden;
      border: 2px solid var(--card-border);
    }

    .photo-tile img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .photo-remove {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      width: 2.125rem;
      height: 2.125rem;
      border-radius: 50%;
      border: none;
      background: rgba(220, 38, 38, 0.95);
      color: white;
      font-size: 1.375rem;
      line-height: 1;
      cursor: pointer;
    }

    .photo-add {
      aspect-ratio: 1 / 1;
      border-radius: var(--radius-md);
      border: 2px dashed rgba(255, 255, 255, 0.35);
      background: rgba(255, 255, 255, 0.06);
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.625rem;
    }

    .photo-add:hover { border-color: var(--primary-pink); }

    .photo-add-icon { font-size: 1.75rem; }
    .photo-add-text { font-weight: 800; font-size: 0.75rem; }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 0.625rem;
      justify-content: center;
      margin-top: 0.625rem;
    }

    .chip {
      border: none;
      border-radius: var(--radius-full);
      padding: 0.625rem 0.875rem;
      font-weight: 800;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.15);
      color: var(--text-primary);
      transition: transform 0.15s, opacity 0.2s;
      font-size: 0.875rem;
    }

    .chip:hover { transform: translateY(-2px); }

    .chip-selected {
      background: linear-gradient(90deg, var(--primary-pink), var(--secondary-purple));
      color: white;
    }

    .interest-add {
      display: flex;
      gap: 0.625rem;
      margin-top: 0.875rem;
    }

    .interest-add .btn { padding: 0.75rem 0.875rem; }

    .bio-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.5rem;
      font-size: 0.8125rem;
      color: var(--text-secondary);
    }

    .nav {
      display: flex;
      gap: 0.75rem;
    }

    .nav .btn { flex: 1; }
    .nav .btn-secondary { flex: 0 0 auto; }

    .success {
      text-align: center;
    }

    .success-badge {
      width: 5.5rem;
      height: 5.5rem;
      margin: 0 auto 0.625rem;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--primary-pink), var(--secondary-purple));
      display: grid;
      place-items: center;
      color: white;
      font-size: 2.625rem;
      font-weight: 900;
    }

    .summary {
      text-align: left;
      margin-top: 1rem;
      padding: 1rem;
      border-radius: var(--radius-md);
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--card-border);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: var(--text-secondary);
      font-size: 0.875rem;
    }

    .summary p { margin: 0.5rem 0; }

    /* Responsive Styles */
    @media (max-width: 768px) {
      .brand-title { font-size: 2rem; }
      .step-title h2 { font-size: 1.5rem; }
      .photos-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .otp-row { gap: 0.5rem; }
      .otp-input { width: 2.75rem; height: 2.75rem; font-size: 1.125rem; }
      .card { padding: 1.25rem; }
      .page { padding: 1rem; }
    }

    @media (max-width: 480px) {
      .brand-title { font-size: 1.75rem; }
      .brand-subtitle { font-size: 1rem; }
      .step-title h2 { font-size: 1.375rem; }
      .gender-grid { grid-template-columns: 1fr; }
      .photos-grid { grid-template-columns: 1fr; }
      .otp-input { width: 2.5rem; height: 2.5rem; font-size: 1rem; }
      .card { padding: 1rem; }
      .nav { flex-direction: column-reverse; }
      .nav .btn { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="background-overlay"></div>

  <main class="page">
    <div class="container">
      <header class="brand-header">
        <h1 class="brand-title">find your valentine ‚ù§Ô∏è</h1>
        <p class="brand-subtitle">Find Love That Lasts</p>
      </header>

      <section class="glass progress" aria-label="Progress">
        <div class="progress-row">
          <span id="progress-step" class="left">Step 1 of 7</span>
          <span id="progress-percent" class="right">14%</span>
        </div>
        <div class="progress-track">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
      </section>

      <section class="glass card" aria-label="Registration">
        <form id="registration-form" novalidate>
        <!-- Step 1 -->
        <div class="step-panel" data-step="1">
          <div class="step-title">
            <h2>Welcome to Find Your Valentine</h2>
            <p>Verify your college email to get started</p>
          </div>

          <div class="row">
            <label for="college-email">College Email</label>
            <input id="college-email" type="email" placeholder="name.branch.year@college.ac.in" autocomplete="email" />
            <div class="error hidden" data-error-for="email">
              <span class="icon">‚ö†</span>
              <span data-error-text></span>
            </div>
          </div>

          <div class="row">
            <button id="btn-send-otp" type="button" class="btn btn-primary">Send OTP</button>
          </div>

          <div id="otp-area" class="hidden">
            <div class="row">
              <label>Enter 6-digit OTP</label>
              <div class="otp-row" aria-label="OTP inputs">
                <input class="otp-input" inputmode="numeric" autocomplete="one-time-code" maxlength="1" />
                <input class="otp-input" inputmode="numeric" maxlength="1" />
                <input class="otp-input" inputmode="numeric" maxlength="1" />
                <input class="otp-input" inputmode="numeric" maxlength="1" />
                <input class="otp-input" inputmode="numeric" maxlength="1" />
                <input class="otp-input" inputmode="numeric" maxlength="1" />
              </div>
              <div class="error hidden" data-error-for="otp">
                <span class="icon">‚ö†</span>
                <span data-error-text></span>
              </div>

              <div class="otp-meta">
                <span>‚è± <span id="otp-timer">2:00</span></span>
                <button id="btn-resend-otp" type="button" class="btn-link">Resend OTP</button>
              </div>
            </div>

            <div class="row">
              <button id="btn-verify-otp" type="button" class="btn btn-primary">Verify OTP</button>
            </div>
          </div>

          <div class="hint-box" aria-label="Email format hint">
            <strong>Email Format:</strong> name.branch.year@college.ac.in
            <br />
            <strong>Example:</strong> john.cs.23@xyz.ac.in
          </div>
        </div>

        <!-- Step 2 -->
        <div class="step-panel hidden" data-step="2">
          <div class="step-title">
            <h2>What's Your Name?</h2>
            <p>This is how you'll appear to others</p>
          </div>

          <div class="row">
            <label for="full-name">Full Name</label>
            <input id="full-name" type="text" placeholder="Enter your full name" autocomplete="name" />
          </div>

          <div class="row">
            <label for="username">Username (unique)</label>
            <input id="username" type="text" placeholder="e.g. john_cs23" autocomplete="username" />
            <small style="opacity:0.85; display:block; margin-top:6px; color: var(--text-secondary);">Allowed: letters, numbers, dot (.), underscore (_). No spaces.</small>
            <div class="error" data-error-for="username"><span data-error-text></span></div>
          </div>

          <div class="row">
            <label for="password">Password</label>
            <input id="password" type="password" placeholder="Create a password" autocomplete="new-password" />
            <div class="error" data-error-for="password"><span data-error-text></span></div>
          </div>

          <div class="derived" aria-label="Derived profile info">
            <p>üìß <span id="derived-email">-</span></p>
            <p>üéì <span id="derived-college">-</span></p>
            <p>üìö <span id="derived-branch">-</span></p>
            <p>üìÖ <span id="derived-year">-</span></p>
          </div>
        </div>

        <!-- Step 3 -->
        <div class="step-panel hidden" data-step="3">
          <div class="step-title">
            <h2>Select Your Gender</h2>
            <p>Help us personalize your experience</p>
          </div>

          <div id="gender-options" class="gender-grid" aria-label="Gender options"></div>
        </div>

        <!-- Step 4 -->
        <div class="step-panel hidden" data-step="4">
          <div class="step-title">
            <h2>Add Your Photos</h2>
            <p>Add at least 2 photos (max 6)</p>
          </div>

          <div id="photos-grid" class="photos-grid" aria-label="Photo grid"></div>
          <input id="photo-input" type="file" accept="image/*" multiple class="hidden" />
        </div>

        <!-- Step 5 -->
        <div class="step-panel hidden" data-step="5">
          <div class="step-title">
            <h2>Your Interests</h2>
            <p>Select at least 5 (max 10)</p>
          </div>

          <div id="interests-wrap" class="chips" aria-label="Interest chips"></div>

          <div class="interest-add">
            <input id="custom-interest" type="text" placeholder="Add custom interest" />
            <button id="btn-add-interest" type="button" class="btn btn-primary" aria-label="Add interest">+</button>
          </div>

          <p id="step-hint" class="hidden" style="text-align:center; margin-top: 12px; color: var(--primary-pink); font-weight: 700;"></p>
        </div>

        <!-- Step 6 -->
        <div class="step-panel hidden" data-step="6">
          <div class="step-title">
            <h2>Tell Us About Yourself</h2>
            <p>Write a bio that stands out (min 50 characters)</p>
          </div>

          <div class="row">
            <label for="bio">Bio (<span id="bio-count">0/500</span>)</label>
            <textarea id="bio" rows="6" placeholder="Share what makes you unique, your passions, what you're looking for..."></textarea>
            <div class="bio-meta">
              <span id="bio-hint" class="hidden" style="color: var(--primary-pink); font-weight:700;"></span>
              <span></span>
            </div>
          </div>
        </div>

        <!-- Step 7 -->
        <div class="step-panel hidden" data-step="7">
          <div class="success">
            <div class="success-badge">‚úì</div>
            <div class="step-title" style="margin-bottom: 0;">
              <h2>You're All Set!</h2>
              <p>Welcome to the community</p>
            </div>

            <div class="summary" aria-label="Profile summary">
              <p><strong>Name:</strong> <span id="summary-name">-</span></p>
              <p><strong>Gender:</strong> <span id="summary-gender">-</span></p>
              <p><strong>College:</strong> <span id="summary-college">-</span></p>
              <p><strong>Branch:</strong> <span id="summary-branch">-</span></p>
              <p><strong>Year:</strong> <span id="summary-year">-</span></p>
              <p><strong>Photos:</strong> <span id="summary-photos">0</span></p>
              <p><strong>Interests:</strong> <span id="summary-interests">-</span></p>
            </div>

            <div class="row">
              <button id="btn-start-matching" type="button" class="btn btn-primary" style="width: 100%; padding: 14px 16px; font-size: 16px;">Start Matching</button>
            </div>
          </div>
        </div>
        </form>
      </section>

      <section id="nav-buttons" class="nav">
        <button id="btn-back" type="button" class="btn btn-secondary">Back</button>
        <button id="btn-continue" type="button" class="btn btn-primary"><span data-btn-label>Continue</span></button>
      </section>
    </div>
  </main>

  <script src="registration.js"></script>
</body>
</html>